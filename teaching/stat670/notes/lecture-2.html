<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="Julia Fukuyama" />
  <title>Stat 470/670 Lecture 2: Univariate Data Visualization</title>
  <style type="text/css">
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" type="text/css" media="screen, projection, print"
    href="https://www.w3.org/Talks/Tools/Slidy2/styles/slidy.css" />
  <script
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
  type="text/javascript"></script>
  <script src="https://www.w3.org/Talks/Tools/Slidy2/scripts/slidy.js"
    charset="utf-8" type="text/javascript"></script>
</head>
<body>
<div class="slide titlepage">
  <h1 class="title">Stat 470/670 Lecture 2: Univariate Data
Visualization</h1>
  <p class="author">
Julia Fukuyama
  </p>
</div>
<div id="the-basicsour-goals" class="slide section level2">
<h1>The basics/Our goals</h1>
<p>Goals:</p>
<ul class="incremental">
<li>Describe a single univariate dataset.</li>
<li>Compare a univariate dataset to a reference distribution or to
another univariate dataset.</li>
<li>Compare many univariate datasets.</li>
</ul>
<p>Even if you have multivariate data, you should start out looking at
the variables one by one, as if they were univariate.</p>
</div>
<div id="describing-a-single-univariate-dataset"
class="slide section level2">
<h1>Describing a single univariate dataset</h1>
<p>Empirical CDF definition:</p>
<p>Let <span class="math inline">\(x_1, \ldots, x_n\)</span> be our
dataset.</p>
<p>The empirical cumulative distribution function (ecdf) is defined as
<span class="math display">\[
\text{ecdf}(x) = \frac{\text{\# of elements in the dataset with value }
\le x}{\text{\# of elements in the dataset}}
\]</span></p>
</div>
<div class="slide section level2">

<p>Properties:</p>
<ul class="incremental">
<li>The function is monotone increasing.</li>
<li>Regions in which the curve is steep <span
class="math inline">\(\leftrightarrow\)</span> regions of high
density.</li>
<li>Regions in which the curve is flat <span
class="math inline">\(\leftrightarrow\)</span> regions of low
density.</li>
<li>Can easily read off the fraction of points in an interval from the
function.</li>
<li>Assuming the samples are exchangeable, there is no loss of
information going from the original dataset to the ecdf.</li>
</ul>
</div>
<div class="slide section level2">

<p>Let’s try this out in R</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="do">## lattice has the singer data that we&#39;re going to use</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="fu">library</span>(stringr)</span></code></pre></div>
<p>Let’s try out ggplot</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="do">## nothing gets plotted! why not?</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">ggplot</span>(singer, <span class="fu">aes</span>(<span class="at">x =</span> height))</span></code></pre></div>
<p><img src="lecture-2-fig/blank-ggplot-1.png" /></p>
</div>
<div class="slide section level2">

<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="do">## we need to tell it not just that we want to plot height, but how to plot it. here we&#39;re saying to plot height as an ecdf</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">ggplot</span>(singer, <span class="fu">aes</span>(<span class="at">x =</span> height)) <span class="sc">+</span> <span class="fu">stat_ecdf</span>()</span></code></pre></div>
<p><img src="lecture-2-fig/ecdf-ggplot-1.png" /></p>
</div>
<div class="slide section level2">

<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="do">## another way of doing the same thing, ggplots can come in pieces</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>singer.gg <span class="ot">=</span> <span class="fu">ggplot</span>(singer, <span class="fu">aes</span>(<span class="at">x =</span> height))</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>singer.gg <span class="sc">+</span> <span class="fu">stat_ecdf</span>()</span></code></pre></div>
<p><img src="lecture-2-fig/ecdf-ggplot-take-2-1.png" /></p>
</div>
<div class="slide section level2">

<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="do">## and if we want to label the axes</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>singer.gg <span class="sc">+</span> <span class="fu">stat_ecdf</span>() <span class="sc">+</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">&quot;This is the x-axis&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;This is the y-axis&quot;</span>) <span class="sc">+</span> </span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;Here&#39;s a title&quot;</span>)</span></code></pre></div>
<p><img src="lecture-2-fig/ecdf-ggplot-labeled-1.png" /></p>
</div>
<div id="other-interpretations-of-the-ecdf"
class="slide section level2">
<h1>Other interpretations of the ECDF</h1>
<p>Let <span class="math inline">\(X\)</span> be a random variable
obtained by drawing uniformly at random from the dataset <span
class="math inline">\(x_1, \ldots, x_n\)</span>.</p>
<p><span class="math display">\[
\text{ecdf}(x) = P(X \le x)
\]</span></p>
</div>
<div class="slide section level2">

<p>Why is the ECDF a good representation of the data?</p>
<p>Remember from your other statistics courses the definition of a
cumulative distribution function:</p>
<p>Let <span class="math inline">\(X\)</span> be a random variable
taking values in <span class="math inline">\(\mathbb R\)</span>, the
cumulative distribution function <span
class="math inline">\(F_X\)</span> is defined as <span
class="math display">\[
F_X(x) = P(X \le x)
\]</span></p>
<p>The empirical CDF is the analogous quantity for our data, and is the
nonparametric maximum likelihood estimate of the population CDF.</p>
</div>
<div id="histograms-and-density-estimates" class="slide section level2">
<h1>Histograms and Density Estimates</h1>
<p>Histogram: Definition</p>
<p>Let <span class="math inline">\(x_{(1)}, \ldots, x_{(n)}\)</span> be
the ordered data.</p>
<ul class="incremental">
<li>Set a number of bins <span class="math inline">\(m\)</span>.</li>
<li>Let <span class="math inline">\(r = x_{(n)} - x_{(1)}\)</span>.</li>
<li>Create <span class="math inline">\(m\)</span> equally sized
intervals: <span class="math inline">\(I_i = [x_{(1)} + \frac{r(i -
1)}{m}, x_{(1)} + \frac{ri}{m} )\)</span></li>
<li>For each <span class="math inline">\(i = 1,\ldots, m\)</span>, let
<span class="math inline">\(c_i = \#\{ j : x_j \in I_i\}\)</span>.</li>
<li>For each interval <span class="math inline">\(I_i\)</span>, plot a
bar with height <span class="math inline">\(c_i\)</span>, width <span
class="math inline">\(r / m\)</span>, centered around <span
class="math inline">\(x_{(1)} + \frac{r(i-1)}{m}\)</span>.</li>
</ul>
</div>
<div id="histogramdensity-estimate-demonstration"
class="slide section level2">
<h1>Histogram/Density estimate demonstration</h1>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">ggplot</span>(singer, <span class="fu">aes</span>(<span class="at">x =</span> height)) <span class="sc">+</span> <span class="fu">geom_histogram</span>()</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="lecture-2-fig/histogram-1.png" /></p>
</div>
<div class="slide section level2">

<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">ggplot</span>(singer, <span class="fu">aes</span>(<span class="at">x =</span> height)) <span class="sc">+</span> <span class="fu">geom_density</span>()</span></code></pre></div>
<p><img src="lecture-2-fig/density-1.png" /></p>
</div>
<div class="slide section level2">

<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">ggplot</span>(singer, <span class="fu">aes</span>(<span class="at">x =</span> height)) <span class="sc">+</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="at">adjust =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>    <span class="fu">geom_rug</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="dv">0</span>), <span class="at">sides =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">height =</span> <span class="dv">0</span>))</span></code></pre></div>
<p><img src="lecture-2-fig/density-with-rug-1.png" /></p>
</div>
<div class="slide section level2">

<p>Exercise: play around with the jittering on the rug and the adjust
parameter in the density. What do you like best? Again, try faceting out
the histograms or plotting them over one another. Do different versions
bring out different features of the data? What do you notice in the
different plots?</p>
</div>
<div class="slide section level2">

<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="dv">5</span>, <span class="dv">1</span>)))</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> x))</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="lecture-2-fig/histogram-simulation-1.png" /></p>
</div>
<div class="slide section level2">

<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> x), <span class="at">bins =</span> <span class="dv">50</span>)</span></code></pre></div>
<p><img src="lecture-2-fig/histogram-simulation-more-bins-1.png" /></p>
</div>
<div class="slide section level2">

<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span> <span class="fu">stat_ecdf</span>(<span class="fu">aes</span>(<span class="at">x =</span> x))</span></code></pre></div>
<p><img src="lecture-2-fig/ecdf-simulation-1.png" /></p>
</div>
<div class="slide section level2">

<p>Drawbacks of histograms:</p>
<ul class="incremental">
<li>Can be sensitive to bin size.</li>
<li>Difficult to compare to each other.</li>
<li>You are implicitly imposing a model on the data, and this can be a
poor fit.</li>
<li>Poor visualization/sensitive to noise when you don’t have much
data.</li>
</ul>
</div>
<div id="q-q-plots" class="slide section level2">
<h1>Q-Q Plots</h1>
<p>Goal: Compare two univariate samples to each other.</p>
<p>Before doing that, we need to define the quantile function.</p>
</div>
<div id="quantile-function-definition" class="slide section level2">
<h1>Quantile function: Definition</h1>
<p>The <span class="math inline">\(f\)</span> quantile, <span
class="math inline">\(q(f)\)</span>, of a set of data is a value with
the property that <em>approximately</em> a fraction <span
class="math inline">\(f\)</span> of the data are less than or equal to
<span class="math inline">\(q(f)\)</span>.</p>
<p>Note: This definition doesn’t completely specify the quantile
function.</p>
</div>
<div class="slide section level2">

<p>For concreteness, we use Cleveland’s definition of the quantile
function:</p>
<ul class="incremental">
<li>Let <span class="math inline">\(x_1, \ldots, x_n\)</span> be the
data from the <span class="math inline">\(n\)</span> samples.</li>
<li>Let <span class="math inline">\(x_{(1)}, \ldots, x_{(n)}\)</span> be
the ordered data, so that <span class="math inline">\(x_{(1)} \le
x_{(2)} \le \cdots \le x_{(n)}\)</span></li>
<li>Let <span class="math inline">\(f_i = \frac{i - .5}{n}\)</span></li>
<li>Let <span class="math inline">\(q(f_i) = x_{(i)}\)</span></li>
</ul>
<p>Now we have a partial specification of a quantile function.</p>
<p>Create the remainder by linear interpolation of the points we do
have.</p>
</div>
<div class="slide section level2">

<p>There isn’t a nice R function for making quantile plots using
Cleveland’s definition, but we can still work it out by hand.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="do">## quantile plots by hand</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>Tenor1 <span class="ot">=</span> singer <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>    <span class="fu">subset</span>(voice.part <span class="sc">==</span> <span class="st">&quot;Tenor 1&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>    <span class="fu">arrange</span>(height)</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="do">## exactly the same as</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>Tenor1 <span class="ot">=</span> <span class="fu">arrange</span>(</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>    <span class="fu">subset</span>(singer, voice.part <span class="sc">==</span> <span class="st">&quot;Tenor 1&quot;</span>), height)</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="do">## close to the same as</span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a><span class="fu">sort</span>(singer<span class="sc">$</span>height[singer<span class="sc">$</span>voice.part <span class="sc">==</span> <span class="st">&quot;Tenor 1&quot;</span>])</span></code></pre></div>
<pre><code>##  [1] 64 64 65 66 66 66 67 67 68 68 68 69 70 70 71 71 72 72 73 74 76</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>nTenor1 <span class="ot">=</span> <span class="fu">nrow</span>(Tenor1)</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>f.value <span class="ot">=</span> (<span class="fl">0.5</span><span class="sc">:</span>(nTenor1 <span class="sc">-</span> <span class="fl">0.5</span>))<span class="sc">/</span>nTenor1</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>Tenor1<span class="sc">$</span>f.value <span class="ot">=</span> f.value</span></code></pre></div>
</div>
<div class="slide section level2">

<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">ggplot</span>(Tenor1, <span class="fu">aes</span>(<span class="at">x =</span> f.value, <span class="at">y =</span> height)) <span class="sc">+</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>    <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="lecture-2-fig/quantile-plot-1.png" /></p>
</div>
<div class="slide section level2">

<p>You can also use the <code>quantile</code> function:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>f.values <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>q.values <span class="ot">=</span> <span class="fu">quantile</span>(Tenor1<span class="sc">$</span>height, <span class="at">probs =</span> f.values)</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(f.values, q.values)) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> f.values, <span class="at">y =</span> q.values))</span></code></pre></div>
<p><img src="lecture-2-fig/quantile-function-r-1.png" /></p>
</div>
<div id="quantile-quantile-q-q-plot-definition"
class="slide section level2">
<h1>Quantile-Quantile (q-q) plot definition</h1>
<p>Suppose we have two sets of univariate measurements, <span
class="math inline">\(x_{(1)}, \ldots, x_{(n)}\)</span> and <span
class="math inline">\(y_{(1)}, \ldots, y_{(m)}\)</span>, with <span
class="math inline">\(m \le n\)</span>.</p>
<p>For each <span class="math inline">\(i = 1,\ldots, m\)</span>, plot
the <span class="math inline">\((i - .5) / m\)</span> quantile of the
<span class="math inline">\(y\)</span> dataset against the <span
class="math inline">\((i - .5) / m\)</span> quantile of the <span
class="math inline">\(x\)</span> dataset.</p>
</div>
<div class="slide section level2">

<p>Note:</p>
<p>If <span class="math inline">\(m = n\)</span>, then</p>
<ul class="incremental">
<li><span class="math inline">\(q_x((i - .5) / m) =
x_{(i)}\)</span></li>
<li><span class="math inline">\(q_y((i - .5) / m) = y_{(i)}\)</span> So
in this case, we are simply plotting <span
class="math inline">\(x_{(i)}\)</span> against <span
class="math inline">\(y_{(i)}\)</span></li>
</ul>
</div>
<div id="q-q-plot-demonstration" class="slide section level2">
<h1>Q-Q plot demonstration</h1>
<p>I will show three ways to make a QQ plot for two samples.</p>
<p>The simplest way is to use the <code>qqplot</code> function:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>Tenor1 <span class="ot">=</span> singer <span class="sc">%&gt;%</span> <span class="fu">subset</span>(voice.part <span class="sc">==</span> <span class="st">&quot;Tenor 1&quot;</span>)</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>Bass2 <span class="ot">=</span> singer <span class="sc">%&gt;%</span> <span class="fu">subset</span>(voice.part <span class="sc">==</span> <span class="st">&quot;Bass 2&quot;</span>)</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="fu">qqplot</span>(Tenor1<span class="sc">$</span>height, Bass2<span class="sc">$</span>height)</span></code></pre></div>
<p><img src="lecture-2-fig/qq-base-1.png" /></p>
</div>
<div class="slide section level2">

<p>If you really want all your plots to be in ggplot, you can ask the
<code>qqplot</code>function to return a data frame that you can plot
with ggplot.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>qq.df <span class="ot">=</span> <span class="fu">as.data.frame</span>(<span class="fu">qqplot</span>(Tenor1<span class="sc">$</span>height, Bass2<span class="sc">$</span>height,</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>    <span class="at">plot.it =</span> <span class="cn">FALSE</span>))</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="fu">ggplot</span>(qq.df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">&quot;Tenor 1&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Bass 2&quot;</span>)</span></code></pre></div>
<p><img src="lecture-2-fig/qq-ggplot-1.png" /></p>
</div>
<div class="slide section level2">

<p>If you want to do it more “by hand,” you can use the
<code>quantile</code> function to get the quantiles of both
distributions and plot them against each other.</p>
<p>The <code>quantile</code> function seems to handle ties a bit
differently than the <code>qqplot</code> function, but this should give
quite similar results.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>f.values <span class="ot">=</span> (<span class="dv">0</span><span class="sc">:</span>(<span class="fu">nrow</span>(Tenor1) <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">/</span> <span class="fu">nrow</span>(Tenor1)</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>q.values.tenor <span class="ot">=</span> <span class="fu">quantile</span>(Tenor1<span class="sc">$</span>height, <span class="at">probs =</span> f.values)</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>q.values.bass <span class="ot">=</span> <span class="fu">quantile</span>(Bass2<span class="sc">$</span>height, <span class="at">probs =</span> f.values)</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(q.values.tenor, q.values.bass)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> q.values.tenor, <span class="at">y =</span> q.values.bass))</span></code></pre></div>
<p><img src="lecture-2-fig/qq-r-quantile-version-1.png" /></p>
</div>
<div id="alternative-compare-two-histograms-or-density-estimates"
class="slide section level2">
<h1>Alternative: compare two histograms or density estimates</h1>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>Tenor1_or_Bass2 <span class="ot">=</span> singer <span class="sc">%&gt;%</span> <span class="fu">subset</span>(voice.part <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Tenor 1&quot;</span>, <span class="st">&quot;Bass 2&quot;</span>))</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="fu">ggplot</span>(Tenor1_or_Bass2) <span class="sc">+</span></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> height, <span class="at">fill =</span> voice.part),</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>                   <span class="at">alpha =</span> .<span class="dv">5</span>, <span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="lecture-2-fig/unnamed-chunk-1-1.png" /></p>
</div>
<div class="slide section level2">

<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">ggplot</span>(Tenor1_or_Bass2) <span class="sc">+</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x =</span> height, <span class="at">fill =</span> voice.part), <span class="at">alpha =</span> .<span class="dv">5</span>)</span></code></pre></div>
<p><img src="lecture-2-fig/unnamed-chunk-2-1.png" /></p>
</div>
<div id="q-normal-plots" class="slide section level2">
<h1>Q-Normal plots</h1>
<p>Goal: Check how well a normal distribution approximates the data</p>
</div>
<div class="slide section level2">

<p>Definition: Theoretical quantiles</p>
<p>Let <span class="math display">\[
q_{\mu, \sigma}(f) = \{ x : P(\mathcal N(\mu, \sigma^2) \le x = f) \}
\]</span></p>
<p>In words: the value <span class="math inline">\(x\)</span> such that
the probability that a <span class="math inline">\(\mathcal N(\mu,
\sigma^2)\)</span> random variable takes value at most <span
class="math inline">\(x\)</span> is equal to <span
class="math inline">\(f\)</span>.</p>
<p>Note the analogy to data quantiles, <span
class="math inline">\(q_x(f)\)</span> defined before.</p>
</div>
<div id="definition-q-normal-plot" class="slide section level2">
<h1>Definition: Q-Normal plot</h1>
<p>Let <span class="math inline">\(x_{(1)}, \ldots, x_{(n)}\)</span> be
our ordered data.</p>
<p>Recall that we defined the sample quantile function at values <span
class="math inline">\(f_i = (i - .5) / n\)</span> as <span
class="math inline">\(q_x(f_i) = x_{(i)}\)</span>.</p>
<p>For each value <span class="math inline">\(f_i\)</span>, <span
class="math inline">\(i = 1,\ldots, n\)</span>, compute</p>
<ul class="incremental">
<li><span class="math inline">\(q_x(f_i)\)</span>, the sample quantile
at <span class="math inline">\(f_i\)</span></li>
<li><span class="math inline">\(q_{0,1}(f_i)\)</span>, the theoretical
quantile for <span class="math inline">\(\mathcal N(0,1)\)</span> at
<span class="math inline">\(f_i\)</span></li>
</ul>
<p>A Q-normal plot shows sample quantiles on the <span
class="math inline">\(y\)</span>-axis and theoretical quantiles on the
<span class="math inline">\(x\)</span>-axis.</p>
</div>
<div class="slide section level2">

<p>Properties:</p>
<ul class="incremental">
<li>If the points lie along the line <span class="math inline">\(y =
x\)</span>, the distribution is well approximated by a <span
class="math inline">\(\mathcal N(0,1)\)</span> distribution.</li>
<li>If the points lie along another straight line with intercept <span
class="math inline">\(\mu\)</span> and slope <span
class="math inline">\(\sigma\)</span>, the distribution is well
approximated by a <span class="math inline">\(\mathcal N(\mu,
\sigma^2)\)</span> distribution.</li>
<li>We can make the analogous plot to check how well our data is
approximated by any distribution.</li>
<li>Q-Q plot (plotting the quantiles of two datasets) can be thought of
as comparing the quantiles of one sample to an estimate of the
distribution of the other sample.</li>
</ul>
</div>
<div id="q-normal-plot-demonstration" class="slide section level2">
<h1>Q-Normal plot demonstration</h1>
<p>Let’s first see what a Q-normal plot looks like when the data really
come from a normal distribution.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>))) <span class="sc">+</span></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>    <span class="fu">stat_qq</span>(<span class="fu">aes</span>(<span class="at">sample =</span> x)) <span class="sc">+</span></span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>))</span></code></pre></div>
<p><img src="lecture-2-fig/qnorm-simulation-1.png" /></p>
<p>Then we have a reference for how closely to the line the points
should lie when we’re looking at real data.</p>
</div>
<div class="slide section level2">

<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="fu">ggplot</span>(singer) <span class="sc">+</span> <span class="fu">stat_qq</span>(<span class="fu">aes</span>(<span class="at">sample =</span> height), <span class="at">distribution =</span> qnorm)</span></code></pre></div>
<p><img src="lecture-2-fig/qnorm-singers-1.png" /></p>
</div>
<div id="summing-up" class="slide section level2">
<h1>Summing up</h1>
<p>To visualize one distribution:</p>
<ul class="incremental">
<li>ECDF</li>
<li>Quantile plot</li>
<li>Density estimate</li>
<li>Histogram</li>
</ul>
<p>To compare two distributions:</p>
<ul class="incremental">
<li>Q-Q plot</li>
<li>Overlay two of the single-distribution plots</li>
</ul>
<p>To compare a distribution to a theoretical distribution:</p>
<ul class="incremental">
<li>Q-normal plot</li>
</ul>
</div>
</body>
</html>
