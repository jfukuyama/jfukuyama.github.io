<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title>Stat 610 Lecture 2: Flow control and looping</title>
  <style type="text/css">
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" type="text/css" media="screen, projection, print"
    href="https://www.w3.org/Talks/Tools/Slidy2/styles/slidy.css" />
  <script
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
  type="text/javascript"></script>
  <script src="https://www.w3.org/Talks/Tools/Slidy2/scripts/slidy.js"
    charset="utf-8" type="text/javascript"></script>
</head>
<body>
<div class="slide titlepage">
  <h1 class="title">Stat 610 Lecture 2: Flow control and looping</h1>
</div>
<div id="today" class="slide section level2">
<h1>Today</h1>
<p>Reading: Matloff Chapter 7.1, 7.2, 2.9</p>
<p>Last time/finish up today: Data structures, so that we have something
to work on.</p>
<p>This time: Flow control, so we can actually do things.</p>
</div>
<div id="flow-control-and-looping" class="slide section level2">
<h1>Flow control and looping</h1>
<ul class="incremental">
<li><p>Conditionals</p></li>
<li><p>Iteration</p></li>
<li><p>Vectorization</p></li>
</ul>
</div>
<div id="if-statements" class="slide section level2">
<h1>if statements</h1>
<p>Syntax</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="cf">if</span> (condition) {</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>    action1</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>    action2</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>}</span></code></pre></div>
<div class="incremental">
<p>So for example:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>weather <span class="ot">&lt;-</span> <span class="st">&quot;sunny&quot;</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="cf">if</span>(weather <span class="sc">==</span> <span class="st">&quot;rainy&quot;</span>) {</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">&quot;Take your umbrella!&quot;</span>)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">&quot;No need for an umbrella today...&quot;</span>)</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;No need for an umbrella today...&quot;</code></pre>
</div>
</div>
<div class="slide section level2">

<p>You can make more complicated conditions using either
<code>else if</code> or nested <code>if</code> statements:</p>
<div class="incremental">
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>weather <span class="ot">&lt;-</span> <span class="st">&quot;cloudy&quot;</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="cf">if</span>(weather <span class="sc">==</span> <span class="st">&quot;rainy&quot;</span>) {</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">&quot;Take your umbrella!&quot;</span>)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (weather <span class="sc">==</span> <span class="st">&quot;cloudy&quot;</span>) {</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">&quot;Think about taking your umbrella&quot;</span>)</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">&quot;No need for an umbrella today...&quot;</span>)</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;Think about taking your umbrella&quot;</code></pre>
</div>
</div>
<div class="slide section level2">

<p>Some rules:</p>
<ul class="incremental">
<li><p><code>if</code> requires <em>one</em> boolean, not a vector. It
will throw a warning if you give it a vector, but it will evaluated
based on just the first element of that vector.</p></li>
<li><p><code>else</code> is optional</p></li>
<li><p>If the action is just one line, you don’t need the braces (but
you should be consistent about this: choose a way you like and stick to
it).</p></li>
</ul>
</div>
<div id="combining-booleans-and-lazy-evaluation"
class="slide section level2">
<h1>Combining booleans and lazy evaluation</h1>
<p>We often want to combine conditions, which we can do with boolean
operations.</p>
<p>Like all other languages, R has AND and OR functions, but unlike some
other languages it has two of each.</p>
<ul class="incremental">
<li><p><code>&amp;</code> and <code>&amp;&amp;</code> both mean
AND.</p></li>
<li><p><code>|</code> and <code>||</code> both mean OR.</p></li>
</ul>
<div class="incremental">
<p>So for example:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>steak_type <span class="ot">&lt;-</span> <span class="st">&quot;med_rare&quot;</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="dv">130</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="cf">if</span>(steak_type <span class="sc">==</span> <span class="st">&quot;rare&quot;</span> <span class="sc">&amp;</span> temp <span class="sc">&gt;</span> <span class="dv">115</span>) {</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">&quot;take your steak off!&quot;</span>)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span>(steak_type <span class="sc">==</span> <span class="st">&quot;med_rare&quot;</span> <span class="sc">&amp;</span> temp <span class="sc">&gt;</span> <span class="dv">125</span>) {</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">&quot;take your steak off!&quot;</span>)        </span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">&quot;you can keep cooking&quot;</span>)</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;take your steak off!&quot;</code></pre>
<p>NB: As we’ll see in two slides, <code>&amp;</code> works here but it
would be better to use <code>&amp;&amp;</code>.</p>
</div>
</div>
<div class="slide section level2">

<p>Or, in not so dire a situation:</p>
<div class="incremental">
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>steak_type <span class="ot">&lt;-</span> <span class="st">&quot;rare&quot;</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="dv">110</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="cf">if</span>(steak_type <span class="sc">==</span> <span class="st">&quot;rare&quot;</span> <span class="sc">&amp;&amp;</span> temp <span class="sc">&gt;</span> <span class="dv">115</span>) {</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">&quot;take your steak off!&quot;</span>)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span>(steak_type <span class="sc">==</span> <span class="st">&quot;med_rare&quot;</span> <span class="sc">&amp;&amp;</span> temp <span class="sc">&gt;</span> <span class="dv">125</span>) {</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">&quot;take your steak off!&quot;</span>)        </span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">&quot;you can keep cooking&quot;</span>)</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;you can keep cooking&quot;</code></pre>
</div>
</div>
<div class="slide section level2">

<p>What is the difference between the two?</p>
<ul class="incremental">
<li>Double operators give scalars (vectors of length 1), single
operators give vectors.</li>
</ul>
<div class="incremental">
<ul class="incremental">
<li>If you call <code>&amp;&amp;</code> or <code>||</code> on a pair of
vectors with length longer than 1, the expression will be evaluated on
the first element of the vector.</li>
</ul>
</div>
<div class="incremental">
<ul class="incremental">
<li><code>&amp;&amp;</code> and <code>||</code> also support <em>lazy
evaluation</em>.</li>
</ul>
</div>
</div>
<div class="slide section level2">

<p>Lazy evaluation:</p>
<ul class="incremental">
<li><p><code>FALSE</code> followed by <code>&amp;&amp;</code> doesn’t
evaluate the second expression.</p></li>
<li><p><code>TRUE</code> followed by <code>||</code> doesn’t evaluate
the second expression.</p></li>
<li><p>This will occasionally make your code faster, so if you remember
to use <code>&amp;&amp;</code> and <code>||</code> for flow control and
put the expressions that are simpler to evaluate first, you will
occasionally get performance improvements.</p></li>
</ul>
<p>Try this on your computer. Which ones are fast and which ones are
slow? Why?</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>(<span class="cn">FALSE</span> <span class="sc">&amp;&amp;</span> <span class="fu">all</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">8</span>) <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>(<span class="cn">FALSE</span> <span class="sc">&amp;</span> <span class="fu">all</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">8</span>) <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>(<span class="fu">all</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">8</span>) <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">&amp;&amp;</span> <span class="cn">FALSE</span>)</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>(<span class="fu">all</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">8</span>) <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">&amp;</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</div>
<div class="slide section level2">

<p>Take-away:</p>
<ul class="incremental">
<li><p>Use <code>&amp;&amp;</code> and <code>||</code> for flow
control.</p></li>
<li><p>Use <code>&amp;</code> and <code>|</code> for operations on
vectors.</p></li>
<li><p>Put simpler operations first when using <code>&amp;&amp;</code>
and <code>||</code>.</p></li>
</ul>
</div>
<div id="iteration" class="slide section level2">
<h1>Iteration</h1>
<p>Two types</p>
<ul class="incremental">
<li><p>For loops: You know how many iterations you need in
advance.</p></li>
<li><p>While loops: You’ll know when to stop when you see it, but you
don’t know in advance.</p></li>
</ul>
</div>
<div id="for-loops" class="slide section level2">
<h1>For loops</h1>
<p>Syntax:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="cf">for</span>(x <span class="cf">in</span> vector) {</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>    ...</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>}</span></code></pre></div>
<p>Rules:</p>
<ul class="incremental">
<li><p><code>vector</code> is a vector</p></li>
<li><p><code>x</code> is a variable, which will be set first to
<code>vector[1]</code>, then to <code>vector[2]</code>, and so on, up to
<code>vector[n]</code>, where <code>n</code> is the length of
<code>vector</code>.</p></li>
<li><p>The actions inside <code>{</code> and <code>}</code> will be
performed for each value of <code>x</code>.</p></li>
</ul>
</div>
<div class="slide section level2">

<p>So for example:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> x) {</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>    <span class="fu">print</span>(i<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] 1
## [1] 4
## [1] 9
## [1] 16
## [1] 25</code></pre>
</div>
<div class="slide section level2">

<p>As with all the other flow control elements, for loops can be
nested.</p>
<div class="incremental">
<p>We can use this to do something slightly more complicated:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(d), <span class="at">ncol =</span> <span class="fu">length</span>(d))</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>D</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4] [,5]
## [1,]   NA   NA   NA   NA   NA
## [2,]   NA   NA   NA   NA   NA
## [3,]   NA   NA   NA   NA   NA
## [4,]   NA   NA   NA   NA   NA
## [5,]   NA   NA   NA   NA   NA</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(D)) {</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(D)) {</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>        <span class="cf">if</span>(i <span class="sc">==</span> j) {</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>            D[i,j] <span class="ot">&lt;-</span> d[i]</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>            D[i,j] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>        }</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>    }</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>}</span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>D</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4] [,5]
## [1,]    1    0    0    0    0
## [2,]    0    2    0    0    0
## [3,]    0    0    3    0    0
## [4,]    0    0    0    4    0
## [5,]    0    0    0    0    5</code></pre>
</div>
</div>
<div class="slide section level2">

<div class="incremental">
<p>They can also be combined with the other flow control elements:</p>
<p>Don’t worry about this part, just data setup:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="do">## install.packages(&quot;Lahman&quot;)</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="do">## install.packages(&quot;pacman&quot;)</span></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="fu">library</span>(Lahman)</span></code></pre></div>
<pre><code>## Error in library(Lahman): there is no package called &#39;Lahman&#39;</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="fu">library</span>(pacman)</span></code></pre></div>
<pre><code>## Error in library(pacman): there is no package called &#39;pacman&#39;</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">p_load</span>(Lahman)</span></code></pre></div>
<pre><code>## Error in p_load(Lahman): could not find function &quot;p_load&quot;</code></pre>
<p>What the data looks like:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="fu">head</span>(People)</span></code></pre></div>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;People&#39; not found</code></pre>
</div>
</div>
<div class="slide section level2">

<div class="incremental">
<p>And finally a for loop: What am I doing here?</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(People)) {</span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.na</span>(People<span class="sc">$</span>height[i]) <span class="sc">&amp;&amp;</span> People<span class="sc">$</span>height[i] <span class="sc">&lt;=</span> <span class="dv">62</span>) {</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>        <span class="fu">print</span>(People[i,])</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>    }</span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;People&#39; not found</code></pre>
<p>Not a data problem: <a
href="https://en.wikipedia.org/wiki/Eddie_Gaedel">Eddie Gaedel</a></p>
<p>Question: does it matter whether we check for NA first? What could
potentially happen if we check for height first instead?</p>
</div>
</div>
<div id="while-loops" class="slide section level2">
<h1>While loops</h1>
<p>Syntax:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="cf">while</span>(condition) {</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>    ...</span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>}</span></code></pre></div>
<p>Rules:</p>
<ul class="incremental">
<li><p>If <code>condition</code> is <code>TRUE</code>, the code inside
<code>{</code> and <code>}</code> will be evaluated.</p></li>
<li><p>After the code inside <code>{</code> and <code>}</code> is
evaluated, <code>condition</code> is checked again, if it is still
<code>TRUE</code>, we go again.</p></li>
<li><p>This repeats until <code>condition</code> is FALSE.</p></li>
</ul>
</div>
<div class="slide section level2">

<p>If you don’t want your while loop to go forever, you have two
options:</p>
<ul class="incremental">
<li><p>The value of <code>condition</code> needs to eventually be set to
<code>FALSE</code> by the code inside <code>{</code> and
<code>}</code>.</p></li>
<li><p>You have a <code>break</code> statement inside the <code>{</code>
<code>}</code> that eventually gets you out of the loop.</p></li>
</ul>
</div>
<div class="slide section level2">

<p>So for example, we could use a while loop to find the largest power
of 2 less than 1000:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a><span class="cf">while</span>(x <span class="sc">*</span> <span class="dv">2</span> <span class="sc">&lt;</span> <span class="dv">1000</span>) {</span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>    x <span class="ot">&lt;-</span> x <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>}</span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>## [1] 512</code></pre>
</div>
<div class="slide section level2">

<p>Or for a slightly less silly example, we could use it to answer a
modified birthday problem.</p>
<p>Suppose we want to know how many classes filled with randomly
selected individuals we would have to attend before we found one where
there were at least two pairs of people with the same birthday.</p>
<p>We could go through the math, or we could get partway to an answer
with a while loop.</p>
<div class="incremental">
<p>Here we draw sets of birthdays for classes of size 20, assuming that
there are 365 days in a year:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>days_in_year <span class="ot">&lt;-</span> <span class="dv">365</span></span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a>class_size <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a>num_classes <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a><span class="cf">while</span>(<span class="cn">TRUE</span>) {</span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a>    num_classes <span class="ot">&lt;-</span> num_classes <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb33-6"><a href="#cb33-6" tabindex="-1"></a>    birthdays <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>days_in_year, class_size, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-7"><a href="#cb33-7" tabindex="-1"></a>    num_birthdays_per_day <span class="ot">&lt;-</span> <span class="fu">table</span>(birthdays)</span>
<span id="cb33-8"><a href="#cb33-8" tabindex="-1"></a>    days_with_match <span class="ot">&lt;-</span> num_birthdays_per_day <span class="sc">&gt;=</span> <span class="dv">2</span></span>
<span id="cb33-9"><a href="#cb33-9" tabindex="-1"></a>    num_days_with_match <span class="ot">&lt;-</span> <span class="fu">sum</span>(days_with_match)</span>
<span id="cb33-10"><a href="#cb33-10" tabindex="-1"></a>    <span class="cf">if</span>(num_days_with_match <span class="sc">&gt;=</span> <span class="dv">2</span>) {</span>
<span id="cb33-11"><a href="#cb33-11" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb33-12"><a href="#cb33-12" tabindex="-1"></a>    }</span>
<span id="cb33-13"><a href="#cb33-13" tabindex="-1"></a>}</span>
<span id="cb33-14"><a href="#cb33-14" tabindex="-1"></a>num_classes</span></code></pre></div>
<pre><code>## [1] 7</code></pre>
</div>
<div class="incremental">
<p>Notes:</p>
<ul class="incremental">
<li><p>The <code>while(TRUE)</code> with a <code>break</code> statement
is a common idiom for while loops.</p></li>
<li><p><code>break</code> can also be used in for loops.</p></li>
</ul>
</div>
</div>
<div id="vectorization" class="slide section level2">
<h1>Vectorization</h1>
<p>Most basic functions in R are <em>vectorized</em>, which means that
they are applied to vectors element-by-element.</p>
<ul class="incremental">
<li><p>We already saw this with vector operations.</p></li>
<li><p>Also true of many base functions.</p></li>
</ul>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="dv">10</span>, <span class="dv">1</span>, .<span class="dv">1</span>)</span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>##  [1]  3.561197 17.614336 10.737847  7.898275  5.727648 24.837668  1.109160
##  [8] 13.389858  6.729989  9.127213</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="fu">log</span>(x)</span></code></pre></div>
<pre><code>##  [1] 1.2700967 2.8687131 2.3737746 2.0666444 1.7453049 3.2123614 0.1036033
##  [8] 2.5944975 1.9065735 2.2112604</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="fu">round</span>(x)</span></code></pre></div>
<pre><code>##  [1]  4 18 11  8  6 25  1 13  7  9</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="fu">floor</span>(x)</span></code></pre></div>
<pre><code>##  [1]  3 17 10  7  5 24  1 13  6  9</code></pre>
</div>
<div class="slide section level2">

<p>More on vectorization and its advantages later. Why
vectorization?</p>
<ul class="incremental">
<li><p>More readable code.</p></li>
<li><p>Instead of writing <em>how</em> you want the computer to perform
the computations, you tell the computer <em>what</em> you want to
do.</p></li>
<li><p>Less typing = less of an opportunity to introduce bugs.</p></li>
<li><p>Can be faster.</p></li>
</ul>
</div>
<div class="slide section level2">

<p>Compare:</p>
<p>for-loop way of computing the floor of all the elements in the vector
<code>x</code>:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a>floor_of_x <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">length</span>(x)) <span class="do">## pre-allocate a vector to hold our computations</span></span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)) {</span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a>    floor_of_x[i] <span class="ot">&lt;-</span> <span class="fu">floor</span>(x[i])</span>
<span id="cb43-4"><a href="#cb43-4" tabindex="-1"></a>}</span>
<span id="cb43-5"><a href="#cb43-5" tabindex="-1"></a>floor_of_x</span></code></pre></div>
<pre><code>##  [1]  3 17 10  7  5 24  1 13  6  9</code></pre>
<div class="incremental">
<p>Versus the vectorized way:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="fu">floor</span>(x)</span></code></pre></div>
<pre><code>##  [1]  3 17 10  7  5 24  1 13  6  9</code></pre>
</div>
</div>
<div id="vectorized-conditionals" class="slide section level2">
<h1>Vectorized conditionals</h1>
<p>Suppose we want to plot the following function.</p>
<p><span class="math display">\[
f(x) = \begin{cases}
\frac{15}{16} (1 - x^2)^2 &amp; |x| &lt; 1\\
0 &amp; \text{o.w.}
\end{cases}
\]</span></p>
</div>
<div class="slide section level2">

<div class="incremental">
<p>Take 1:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="at">length =</span> <span class="dv">200</span>) <span class="do">## a vector with the values at which we want to evaluate f</span></span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a>fx <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">200</span>) <span class="do">## pre-allocate a vector in which to store the values of f(x)</span></span>
<span id="cb47-3"><a href="#cb47-3" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>) {</span>
<span id="cb47-4"><a href="#cb47-4" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">abs</span>(x[i]) <span class="sc">&lt;</span> <span class="dv">1</span>) {</span>
<span id="cb47-5"><a href="#cb47-5" tabindex="-1"></a>        fx[i] <span class="ot">&lt;-</span> <span class="dv">15</span><span class="sc">/</span><span class="dv">16</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> x[i]<span class="sc">^</span><span class="dv">2</span>)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb47-6"><a href="#cb47-6" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb47-7"><a href="#cb47-7" tabindex="-1"></a>        fx[i] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb47-8"><a href="#cb47-8" tabindex="-1"></a>    }</span>
<span id="cb47-9"><a href="#cb47-9" tabindex="-1"></a>}</span>
<span id="cb47-10"><a href="#cb47-10" tabindex="-1"></a><span class="fu">plot</span>(fx <span class="sc">~</span> x, <span class="at">type =</span> <span class="st">&#39;l&#39;</span>)</span></code></pre></div>
<p><img src="lecture-2-fig/unnamed-chunk-22-1.png" /></p>
</div>
</div>
<div id="ifelse-vectorized-conditionals" class="slide section level2">
<h1>ifelse: Vectorized conditionals</h1>
<p><code>ifelse</code> syntax:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a><span class="fu">ifelse</span>(condition, yes, no)</span></code></pre></div>
<p>Rules:</p>
<ul class="incremental">
<li><p><code>ifelse</code> returns a vector</p></li>
<li><p><code>condition</code> is a vector of Booleans.</p></li>
<li><p><code>yes</code> and <code>no</code> are vectors, should be of
the same type.</p></li>
</ul>
<div class="incremental">
<p><code>ifelse</code> goes element-by-element through
<code>condition</code>, <code>yes</code>, and <code>no</code>.</p>
<ul class="incremental">
<li><p>The <code>i</code>th element of the output is <code>yes[i]</code>
if <code>condition[i]</code> is <code>TRUE</code></p></li>
<li><p>The <code>i</code>th element of the output is <code>no[i]</code>
if <code>condition[i]</code> is <code>FALSE</code></p></li>
</ul>
</div>
</div>
<div class="slide section level2">

<div class="incremental">
<p>Take 2:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="at">length.out =</span> <span class="dv">200</span>)</span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">abs</span>(x) <span class="sc">&lt;</span> <span class="dv">1</span>, <span class="dv">15</span><span class="sc">/</span><span class="dv">16</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">^</span><span class="dv">2</span>, <span class="dv">0</span>)</span></code></pre></div>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a><span class="fu">plot</span>(y <span class="sc">~</span> x, <span class="at">type =</span> <span class="st">&#39;l&#39;</span>)</span></code></pre></div>
<p><img src="lecture-2-fig/unnamed-chunk-25-1.png" /></p>
</div>
</div>
</body>
</html>
